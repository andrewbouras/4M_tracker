import{a as Kn}from"./chunk-SHTXH6FZ.js";import{a as _n,b as $n,d as zn,e as jn,f as Zn}from"./chunk-SQ2J5G23.js";import{a as Ft}from"./chunk-IUNHH544.js";import{a as ko}from"./chunk-SWJ57CIZ.js";import{a as Tt}from"./chunk-NJHVGQ3T.js";import{d as Wn}from"./chunk-V4KRVOHD.js";import{f as Gn}from"./chunk-2WTSXO3L.js";import{h as On,j as Hn}from"./chunk-5LRZ7IFN.js";import{O as Ln,db as Ye,v as Vn}from"./chunk-ATEHMOFB.js";import{e as J}from"./chunk-2P7VAWV5.js";import{K as Nn,ha as lt,ta as Un}from"./chunk-3HK6ZC5T.js";import{a as Dn}from"./chunk-ACZGMNYK.js";import{o as qt}from"./chunk-U5F4RDP5.js";import{f as at,g as p,i as Sn,j as Fn,k as kn,n as xn,p as wn,s as Cn,t as vn,x as Mn}from"./chunk-LLAFONE3.js";import{Ba as nn,Cd as In,D as tn,Dd as Rn,Fc as ln,Fd as Ge,Jc as un,Mc as pn,Qc as fn,Rb as Xe,Sb as sn,Tc as gn,Wc as dt,Yc as bn,dd as yn,id as An,kb as on,lb as rn,ld as hn,mc as st,md as Tn,nd as Oe,oc as an,pc as Le,pd as He,rc as dn,vc as cn,vd as En,xc as mn,yc as ht,za as Be}from"./chunk-4CMCOVQN.js";import{h as At}from"./chunk-WZYS47J2.js";import{b as it}from"./chunk-AIQ7AHJY.js";import{$ as Ce,T as Jt}from"./chunk-6V7ED5GE.js";import{h as xe}from"./chunk-T3HNWLEC.js";import{Cb as Zt,He as rt,L as nt,Lb as Xt,Td as we,_b as Yt,gb as E,ib as Ze,ie as en,jd as Ve,qd as Qt,x as Vt}from"./chunk-XKUMOCJO.js";import{T as Pn,b as ct,l as z,m as H,r as Bn,v as mt}from"./chunk-G7PMLIMH.js";import{a as d,m as ke}from"./chunk-FI5JCZQR.js";import{Pa as ot,ka as jt,va as Ne}from"./chunk-RISGBUNP.js";import{c as Lt}from"./chunk-X6UT6LAC.js";import{$ as zt,S as Gt,U as Wt,V as Kt,X as _t,_ as $t,b as ge,ca as yt,da as Re,f as Ot,x as Ht}from"./chunk-HTY4DAML.js";import{a as N}from"./chunk-6MAAUKN7.js";import{f as v,h as i,m as Buffer,n as a}from"./chunk-3KENBVE7.js";i();a();var We=v(N());i();a();var Ee=v(N());i();a();var ve=v(N()),Xn=({goHome:e})=>ve.default.createElement(z,{height:"100%",paddingY:36,paddingX:"screen",justifyContent:"center",alignItems:"center"},ve.default.createElement(z,{flex:1,justifyContent:"center",alignItems:"center"},ve.default.createElement(z,{marginBottom:24},ve.default.createElement(mt,{icon:"X",size:64,shape:"circle",backgroundColor:"accentAlert"})),ve.default.createElement(H,{color:"textPrimary",align:"center",font:"title1Semibold",marginBottom:8},d.t("sendErrorTitle")),ve.default.createElement(H,{color:"textSecondary",align:"center",font:"body"},d.t("sendErrorFallback"))),ve.default.createElement(Bn,{theme:"secondary",onPress:e},d.t("homeTab")));var kt=(0,Ee.createContext)(!1),kr=({goHome:e,children:t})=>{let n=(0,Ee.useCallback)(()=>{p.getState().resetSendSlice(),e()},[e]);return Ee.default.createElement(Dn,{fallback:o=>{if(o instanceof at)return Ee.default.createElement(Xn,{goHome:n});throw o}},Ee.default.createElement(kt.Provider,{value:!0},t))};i();a();var Qn=v(N());i();a();var xt=(e,t)=>{let n=xe(e,4);return t?`${t} (${n})`:n};i();a();i();a();var Yn=(e,t)=>{let{getExistingAccount:n,getKnownAddressLabel:o}=Ce();if(!e)return null;let r=n(e),s=o(e,t),m=r?r.name:s;return m||null};var wt=({recipient:e,recipientHandle:t,networkID:n})=>{let o=Yn(e,n),{data:r}=un(e,n),s=r?.address&&e;return{recipient:r?.address?r.address:e,recipientHandle:t||o||s||""}};var ut=()=>{let e=p(s=>s.sendFormValues.recipient),t=p(s=>s.sendFormValues.recipientHandle),n=p(s=>s.fungibleKey),o=p(s=>s.splTokenAccount),{fungible:r}=Oe({key:n,splTokenAccount:o});return wt({recipient:e,recipientHandle:t,networkID:r?.data.chain.id??Ze.Solana.Mainnet})},Ct=()=>{let{recipient:e,recipientHandle:t}=ut();return(0,Qn.useMemo)(()=>xt(e,t),[e,t])};var se=()=>{if(!(0,We.useContext)(kt))throw new Error("useSendFungibleFlow must be used within a SendFungibleFlowErrorBoundary");let t=p(R=>R.fungibleKey),n=p(R=>R.splTokenAccount),{fungible:o}=Oe({key:t,splTokenAccount:n}),[r]=(0,We.useState)(o),{data:s}=rt({address:r?.data.walletAddress,networkID:r?.data.chain.id});if(!s||!r)throw new at("senderAddress or fungible is undefined, send flow is broken");let{data:m,type:f}=r,{chain:l,decimals:c,logoUri:u,symbol:C,tokenAddress:T,balance:D,key:L}=m,U=l.id,M=C??(T?xe(T,4):d.t("tokenRowUnknownToken")),S=T??"",x=f==="SPL"?r.data.programId:null,F=Ct(),G=p(R=>R.sendFormValues),{amountAsset:K}=G,A=Re(K,c),B=`${Ge(A,c)} ${M}`,P=(0,We.useMemo)(()=>hn(r),[r]),{data:k}=dn({query:P?{data:P}:void 0}),{fromUsd:I,formatLocalizedPrice:w}=it(),_=k?.usd??0,$=Xe(A.toNumber(),_),j=I($),Se=w(j),be=_?`~${Se}`:"-",Ie=yn(r);return{senderAddress:s,networkID:U,tokenAddress:S,symbol:M,balance:D,decimals:c,programId:x,formattedRecipient:F,uiAmount:A,usdPriceOfToken:_,formattedUiAmount:B,formattedCurrencyAmount:be,tokenPrice:Se,logoUri:u,type:f,key:L,transferFeePercent:Ie}};i();a();var pt=v(N());i();a();i();a();var xo=[on.toString(),rn.toString()],Jn=async(e,t)=>{let n=nn(t);try{let o=await n.getParsedAccountInfo(new nt.PublicKey(e));if(o&&xo.includes(o.value?.owner.toString()??"")&&"mintAuthority"in(o.value?.data).parsed.info)return!0}catch{}return!1};var wo=1*24*60*1e3,Co=1*60*1e3,eo=({address:e,networkID:t})=>jt({queryKey:["is-mint-account",e],queryFn:async()=>{if(!E.isSolanaNetworkID(t))throw new Error("Attempting to get mint account for non-Solana network");return Jn(e,t)},enabled:!!e&&E.isSolanaNetworkID(t),gcTime:wo,staleTime:Co});i();a();var no=v(N());i();a();var to=890880,Qe=()=>{let{senderAddress:e,type:t}=se(),n=p(m=>m.sendFormValues),o=t==="SolanaNative",{data:r}=xn({...e,address:n.recipient},o);return o&&typeof r<"u"&&r<to?to:0};var oo=(e,t,n)=>{let{fungibleKey:o,splTokenAccount:r}=p(D=>({fungibleKey:D.fungibleKey,splTokenAccount:D.splTokenAccount})),{data:[s]}=ot(["kill-send-simulation"]),m=Qe(),f=(0,no.useMemo)(()=>{if(!(!e||s))return{sendSessionId:"simulate-send",shouldShowFiatValues:!1,fungibleKey:o,splTokenAccount:r,confirmedFungibleAndSender:null,sendFormValues:{recipient:t,recipientHandle:"",amountAsset:new ge(m===0?1:m),solana:{references:[]}},gasEstimation:void 0}},[s,m,e,o,t,r]),{data:l,isLoading:c}=He(f),u={type:"transaction",userAccount:e,params:void 0,url:"https://phantom.com",networkID:n};l&&(E.isEVMNetworkID(l.networkID)&&(u.params={transactions:[l.unsignedTransaction]}),E.isSolanaNetworkID(l.networkID)&&(u.params={transactions:l.transaction.map(D=>Vt(D)),method:"signAndSendTransaction"}));let{data:C,isLoading:T}=Un(u,{disabled:!l||s,disableRefetch:!0});return{data:C,isLoading:!s&&(c||T)}};var vo=(e,t)=>({address:e,addressType:Zt(t,e),networkID:t}),Eo=({senderAddress:e,senderAccounts:t,networkID:n})=>(0,pt.useMemo)(()=>e?t.reduce((o,r)=>{let s=r.addresses.filter(m=>m.networkID===n&&m.address!==e);if(n)for(let m of s)o.push({label:r.name,address:m.address,chainID:n});return o},[]):[],[e,t,n]);function Io(e){if(!e)return"";let{warnings:t=[],error:n=""}=e;return n==="UNKNOWN_ERROR"?t[0]?.message:n==="INSUFFICIENT_FUNDS"?d.t(`sendWarning_${n}`):""}var Ro=({senderAddress:e,recipient:t,networkID:n})=>{let{data:o,isLoading:r}=oo(e??"",t,n);return{simulationWarning:Io(o),isSimulationLoading:r}},No=({recipient:e,networkID:t})=>{let{currentRecipient:n,isStaleRecipient:o,recipientError:r}=fn(e,t);return!o&&!r&&n.length>0?n:""},Bo=({recipient:e,networkID:t})=>{let{data:n=[],isLoading:o}=An({chainAddresses:e?[vo(e,t)]:[]});return{recipientHasZeroBalance:(0,pt.useMemo)(()=>n.length===1&&n[0].data.amount==="0",[n]),recipientTokensIsLoading:o}},qe=({senderAddress:e,senderAccounts:t,networkID:n,recipient:o})=>{let{recentAddresses:r,savedAddresses:s}=Ce(),m=Eo({senderAddress:e,senderAccounts:t,networkID:n}),f=No({recipient:o,networkID:n}),{recipientHasZeroBalance:l,recipientTokensIsLoading:c}=Bo({recipient:f,networkID:n}),{data:u,isLoading:C}=eo({address:f,networkID:n}),{simulationWarning:T,isSimulationLoading:D}=Ro({senderAddress:e??"",recipient:f,networkID:n}),L=!f||c||C&&E.isSolanaNetworkID(n)||D;return{sendAddressWarning:(0,pt.useMemo)(()=>L||!e?null:u?d.t("sendMintAccountWarning"):m.find(S=>S.address===f)?null:T||(r.addresses.find(S=>S.address===o)||s.addresses.find(S=>S.address===o)?null:e===f?d.t("sendSameAddressWarning"):l?d.t("sendRecipientZeroBalanceWarning"):d.t("sendUnknownAddressWarning")),[r,s,o,f,m,e,l,u,T,L]),sendAddressVariant:u?"danger":"warning"}};i();a();var V=v(N());i();a();function ro(e,t){return e.isZero()?new ge(Be.get(t).amountForGasEstimation??0):e}var Po=Ht({seconds:10}),Do=({onClose:e,onNext:t})=>{let{senderAddress:n,networkID:o,decimals:r,programId:s,type:m,balance:f,usdPriceOfToken:l,symbol:c,logoUri:u,formattedUiAmount:C,formattedCurrencyAmount:T}=se(),D=Qe(),L=Re(D,r).toNumber(),[U,M]=(0,V.useState)(""),S=(0,V.useMemo)(()=>{try{let b=new ge(U);if(!b.isNaN())return b}catch{}return new ge(0)},[U]),x=p(b=>b),F=p(b=>b.sendFormValues),G=p(b=>b.resetSendSlice),{amountAsset:K,amountUsd:A,recipient:B}=F,P=p(b=>b.setSendFormValues),k=p(b=>b.shouldShowFiatValues),I=p(b=>b.setShouldShowFiatValues),w=s===Xt,_=F.solana.memo,$=(0,V.useMemo)(()=>{let b=x.sendFormValues.recipient;return{...x,sendFormValues:{...F,recipient:b||n.address,amountAsset:ro(F.amountAsset,o)}}},[F,x,n,o]),{data:j}=He($),{data:Se}=Le({networkID:o,multichainTransaction:j,transactionSpeed:"fastest",queryOptions:{refetchInterval:Po}}),{currencySymbol:be,currencyCode:Ie,toUsd:R,fromUsd:ye,formatLocalizedPrice:te}=it(),Pe=kn({chainAddress:n,type:m,balance:f,decimals:r,recipient:B,gasEstimation:Se,clampToZero:!0}),ne=Re(Pe??0,r),le=Xe(ne.toNumber(),l),oe=ye(le,2),X=k?be:void 0,Ae=k?void 0:` ${c}`,q=k?Ie:c,re=(0,V.useMemo)(()=>{if(S.isZero())return;let b=dt.get(o),O=k?b.minimumSendableCurrencyAmount:L,Fe=k?oe:ne,je=S.lt(O),bt=S.gt(Fe);return je?d.t("sendFormErrorMinRequiredInterpolated",{minAmount:O,tokenName:q}):bt?d.t("sendFormErrorInsufficientBalance"):void 0},[S,k,o,oe,ne,L,q]),Z=(0,V.useCallback)(b=>{let O=$t(b),Fe=zt(O,r);M(Fe)},[r]),ue=(0,V.useCallback)(()=>{let b=Re(K,r).toString(10),O=ye(A??0).toString(10);Z(k?b:O),I(!k)},[k,I,K,A,r,Z,ye]),_e=(0,V.useCallback)(()=>{Z(k?oe.toString(10):ne.toString(10))},[Z,k,ne,oe]);(0,V.useEffect)(()=>{let b,O,Fe;k?(Fe=S.toNumber(),O=R(Fe),b=yt(sn(O,l,r),r)):(b=yt(S,r),O=Xe(S.toNumber(),l)),P({...p.getState().sendFormValues,amountAsset:b,amountUsd:O})},[P,S,k,l,r,R]),(0,V.useEffect)(()=>{if(U)return;let b=k?A:Re(K,r).toNumber();b&&M(b.toString())},[]);let De=(0,V.useMemo)(()=>k?l?`${C}`:`??? ${c}`:`${T}`,[k,l,c,C,T]),he=(0,V.useMemo)(()=>{let b=X??"",O=Ae??"";return k?`${te(oe)}`:`${b}${Ge(ne)}${O}`},[k,oe,ne,X,Ae,te]),$e=(0,V.useCallback)(b=>{let O=F.solana;O.memo=b,P({...F,solana:O})},[F,P]),ie=(0,V.useMemo)(()=>!re&&K.gt(0),[re,K]),tt=(0,V.useCallback)(()=>{ie&&t()},[ie,t]),ze=(0,V.useCallback)(()=>{e(),G()},[e,G]),Te=(0,V.useMemo)(()=>({next:d.t("commandNext"),send:d.t("commandSend"),cancel:d.t("commandCancel"),maxInput:d.t("maxInputMax"),inputAmountPlaceholder:d.t("maxInputAmount"),recipientAddress:d.t("sendRecipientAddress"),memoPlaceholder:d.t("sendMemoOptional"),availableToSend:d.t("availableToSend"),available:d.t("available"),pageTitle:`${d.t("commandSend")} ${c}`}),[c]),Ue=E.isMainnetNetworkID(o);return{networkID:o,handleClose:ze,handleInputChange:Z,handleMemoChange:$e,handleNext:tt,primaryTextPrefix:X,primaryText:U,primaryTextSuffix:Ae,toggleDenomination:ue,errorText:re,secondaryText:De,formattedMaxAmount:he,primarySymbol:q,symbol:c,decimals:r,logoUri:u,canGoNext:ie,i18nStrings:Te,handleSetMax:_e,showSecondaryText:Ue,canSendCurrencyAmount:Ue&&!!l,isMemoEnabled:w,memo:_}};i();a();var ce=v(N());var Uo=({onClose:e,onRecipientNavigation:t,onAmountNavigation:n,networkID:o})=>{let{recipientHandle:r}=p(A=>A.sendFormValues),{data:s,isLoading:m}=Nn({usernameOrUserProfileId:r}),f=(0,ce.useMemo)(()=>{if(s?.addresses)return Object.keys(s.addresses)},[s]),{fungibles:l,isLoadingTokens:c,visibilityOverrides:u}=Tn(),C=(0,ce.useMemo)(()=>{let A=o?l.filter(P=>P.data.chain.id===o):l;return(f?A.filter(P=>f.includes(P.data.chain.id)):A).filter(P=>P.type!=="CompressedSPL")},[o,l,f]),[T,D]=(0,ce.useState)(""),L=Wt(T)??"",U=Kt(C,L,En),M=p(A=>A.resetSendSlice),S=(0,ce.useMemo)(()=>({close:d.t("commandClose"),search:d.t("assetListSearch"),unknownToken:d.t("assetDetailUnknownToken"),noTokens:d.t("sendNoTokens")}),[]),x=(0,ce.useCallback)(A=>D(A),[D]),F=(0,ce.useCallback)(()=>{e(),M()},[e,M]),G=(0,ce.useCallback)(A=>{let B=p.getState().fungibleKey;B&&B!==A.data.key&&p.getState().resetSendSlice(),p.setState({fungibleKey:A.data.key,splTokenAccount:A.type==="SPL"?A.data.splTokenAccountPubkey:void 0});let P=p.getState().sendFormValues;if(P.recipientHandle&&!P.recipient){let k=s?.addresses[A.data.chain.id];if(k){p.setState({sendFormValues:{...P,recipient:k}}),n();return}}t()},[t,n,s?.addresses]);return{fungibles:U,isLoading:c||m,visibilityOverrides:u,searchQuery:T,handleSearch:x,handleClose:F,handleSelect:G,i18nStrings:S}};i();a();i();a();var vt=v(N());var Et=()=>{let e=p(c=>c.analyticsRecipient),t=p(c=>c.fungibleKey),n=p(c=>c.splTokenAccount),{fungible:o}=Oe({key:t,splTokenAccount:n}),{data:r=[]}=we(),{data:s}=Qt(),m=(0,vt.useMemo)(()=>r.some(c=>c.addresses.some(u=>u.address===e?.address)),[r,e]),f=o?.data.chain.id??Ze.Solana.Mainnet,{data:l}=rt({address:o?.data.walletAddress,networkID:f});return(0,vt.useMemo)(()=>({assetType:"token",networkId:f,recipient:e,senderAddress:l?.address??"",senderUsername:s?.username??"",tokenAddress:o?.data.tokenAddress??"",tokenSymbol:o?.data.symbol??"",tokenType:o?.type,selfSend:m}),[f,e,l?.address,s?.username,o,m])};i();a();var Mo=v(N());i();a();var Vo=v(N());i();a();var Q=v(N());i();a();var ao=v(N(),1),co=v(N(),1),Lo=e=>typeof e=="function",so=(e,t)=>Lo(e)?e(t):e,Oo=(()=>{let e=0;return()=>(++e).toString()})();var Ho=20,ft=new Map,Go=1e3,io=e=>{if(ft.has(e))return;let t=setTimeout(()=>{ft.delete(e),gt({type:4,toastId:e})},Go);ft.set(e,t)},Wo=e=>{let t=ft.get(e);t&&clearTimeout(t)},Rt=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,Ho)};case 1:return t.toast.id&&Wo(t.toast.id),{...e,toasts:e.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case 2:let{toast:n}=t;return e.toasts.find(s=>s.id===n.id)?Rt(e,{type:1,toast:n}):Rt(e,{type:0,toast:n});case 3:let{toastId:o}=t;return o?io(o):e.toasts.forEach(s=>{io(s.id)}),{...e,toasts:e.toasts.map(s=>s.id===o||o===void 0?{...s,visible:!1}:s)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let r=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+r}))}}},Ko=[],It={toasts:[],pausedAt:void 0},gt=e=>{It=Rt(It,e),Ko.forEach(t=>{t(It)})};var _o=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:n?.id||Oo()}),Je=e=>(t,n)=>{let o=_o(t,e,n);return gt({type:2,toast:o}),o.id},ee=(e,t)=>Je("blank")(e,t);ee.error=Je("error");ee.success=Je("success");ee.loading=Je("loading");ee.custom=Je("custom");ee.dismiss=e=>{gt({type:3,toastId:e})};ee.remove=e=>gt({type:4,toastId:e});ee.promise=(e,t,n)=>{let o=ee.loading(t.loading,{...n,...n?.loading});return e.then(r=>(ee.success(so(t.success,r),{id:o,...n,...n?.success}),r)).catch(r=>{ee.error(so(t.error,r),{id:o,...n,...n?.error})}),e};i();a();var mo=v(N()),lo=({networkID:e,transactionUnitAmount:t,onTransactionSpeedChange:n})=>{let{status:o,data:r}=st({networkID:e}),{transactionSpeed:s}=p(f=>f.sendFormValues),m=(0,mo.useMemo)(()=>{if(o!=="error"&&r&&s)return()=>n({transactionSpeed:s,transactionUnitAmount:t})},[n,s,t,r,o]);return{transactionSpeed:s,openTransactionSettings:m}};var jo=({networkID:e,formattedRecipient:t,networkName:n,networkFee:o,networkFeeErrorMsg:r,networkFeeRow:s,displayFeeTooltip:m,transferFeePercent:f,solanaMetadata:l,ValueLoader:c,openTransactionSettings:u,onNetworkFeeDescriptionPress:C,onTransferFeePress:T})=>(0,Q.useMemo)(()=>[E.isSolanaNetworkID(e)&&l.label?{label:d.t("sendConfirmationLabel"),value:l.label}:void 0,E.isSolanaNetworkID(e)&&l.message?{label:d.t("sendConfirmationMessage"),value:l.message}:void 0,{label:d.t("transactionsTo"),value:t},{label:d.t("sendFungibleSummaryNetwork"),value:n},{label:d.t("sendFungibleSummaryNetworkFee"),value:o.length>0?o:r?null:c,color:r?ct.colors.legacy.accentAlert:ct.colors.legacy.white,leftSubtext:r||void 0,leftSubtextColor:ct.colors.legacy.accentAlert,rightSubtext:s?.rightSubtext,tooltipContent:m?d.t("networkFeesTooltipDescription",{chainName:n})||"":void 0,onClick:m?u:void 0,onPress:m?u:void 0,handleTooltip:m?C:void 0},f?{label:d.t("sendFungibleTransferFee"),value:`${f}%`,tooltipContent:d.t("sendFungibleTransferFeeToolTip")||"",handleTooltip:T}:void 0,l.memo?{label:d.t("sendMemo"),value:l.memo.replace(/(\r\n|\n|\r)/gm," ")}:void 0].filter(Ot),[m,o,r,s?.rightSubtext,e,n,C,T,u,t,l.label,l.memo,l.message,f,c]),Zo=({hasSufficientFunds:e,isTransactionUnitError:t,isTransactionCreationError:n,hasGasEstimationFailed:o,nativeTokenSymbol:r})=>t?d.t("transactionGasLimitError"):o?d.t("transactionGasEstimationError"):e==="insufficient"?d.t("transactionNotEnoughNative",{nativeTokenSymbol:r}):n?d.t("transactionCreationError"):"",Xo=({onNext:e,onClose:t,ValueLoader:n,onTransactionSpeedChange:o,onNetworkFeeDescriptionPress:r,onTransferFeePress:s,onSubmissionCheckFail:m,copyToClipboard:f})=>{let l=Ve(),{senderAddress:c,networkID:u,symbol:C,formattedRecipient:T,uiAmount:D,key:L,type:U,transferFeePercent:M}=se(),S=p(),x=p(Y=>Y.sendFormValues),F=p(Y=>Y.setSendFormValues),{amountAsset:G,solana:K}=x,A=E.getNetworkName(u);Mn(c,"SEND_FUNGIBLE");let{data:B,isError:P}=He(S),{data:k,isError:I}=an(B),w=(0,Q.useCallback)(({transactionSpeed:Y,transactionUnitAmount:ae})=>{o({transactionSpeed:Y,transactionUnitAmount:ae,sendFormValues:x,setSendFormValues:F,networkID:u})},[F,x,u,o]),{transactionSpeed:_,openTransactionSettings:$}=lo({networkID:u,transactionUnitAmount:k,onTransactionSpeedChange:w}),{data:j,isFetched:Se,isSuccess:be}=Le({networkID:u,multichainTransaction:B,transactionSpeed:_,queryOptions:{refetchInterval:!1}}),{data:Ie}=cn(u,j),R=ln(c),ye=bn(U)?G:new ge(0),{hasSufficientFunds:te,isLoading:Pe,nativeTokenSymbol:ne}=wn(u,c?.addressType,j,ye,x.recipient),le=pn({networkID:u,gasEstimation:j,gasEstimationPrice:Ie}),oe=vn(j,d.t),{data:X}=st({networkID:u}),Ae=(0,Q.useMemo)(()=>Be.get(u).supportsNetworkSettings&&Object.keys(X??{}).length>1,[X,u]),q=p(Y=>Y.setGasEstimation);(0,Q.useEffect)(()=>{j&&q(j)},[j,q]),(0,Q.useEffect)(()=>{l.capture("sendAssetSummary",{data:{type:"fungible",symbol:C,networkId:u,chainId:E.getChainID(u)}})},[u,C,l]);let{data:re=[]}=we(),{sendAddressVariant:Z}=qe({senderAddress:c?.address,senderAccounts:re,networkID:u,recipient:x.recipient}),ue=Se&&!be,_e=!!j&&!Pe&&te!=="insufficient"&&!!le&&Z!=="danger",De=Zo({hasSufficientFunds:te,isTransactionUnitError:I,isTransactionCreationError:P,hasGasEstimationFailed:ue,nativeTokenSymbol:ne}),he=(0,Q.useCallback)(()=>B?R?(l.capture("showFungibleTxSubmissionFailureModal"),m(R),!1):(F({...x,multichainTransaction:B}),!0):!1,[B,R,F,x,l,m]),$e=Gt((0,Q.useCallback)(()=>{if(!he())return;let ae={chainID:u,amount:D.toString(),symbol:C,address:L};Ne.addBreadcrumb("fungibles","approved","info",ae),e()},[he,C,D,u,e,L]),1e3),ie=jo({networkID:u,formattedRecipient:T,networkName:A,networkFee:le,networkFeeErrorMsg:De,networkFeeRow:oe,transferFeePercent:M,solanaMetadata:K,displayFeeTooltip:Ae,ValueLoader:n,openTransactionSettings:$,onNetworkFeeDescriptionPress:r,onTransferFeePress:s}),tt=(0,Q.useMemo)(()=>{let Y=B&&tn(B)?B.transaction.map(ae=>{let b=Buffer.from(ae.serialize({verifySignatures:!1,requireAllSignatures:!1})).toString("base64");return{label:d.t("notificationCopyTransactionText"),value:b.slice(0,8),onClick:()=>{f(b),ee.success(d.t("notificationTransactionCopied"))}}}):[];return[...ie,...Y]},[ie,B,f]),ze=(0,Q.useCallback)(()=>{t(),S.resetSendSlice()},[t,S]),Te=Kn(d.language,E.isSolanaNetworkID(u)),Ue=(0,Q.useMemo)(()=>({title:d.t("sendConfirmationPrimaryText"),send:d.t("commandSend"),cancel:d.t("commandCancel")}),[]);return{senderAddress:c?.address,networkID:u,handleNext:$e,handleClose:ze,canSend:_e,txSubmissionCheckFailureModal:R,summaryRows:Lt()?tt:ie,i18nStrings:Ue,networkHealth:Te}};i();a();var g=v(N()),po=v(ko());i();a();var uo=_t(Ve,e=>new Nt(e)),Nt=class{#e;constructor(t){this.#e=t}onSendFlowStart({assetType:t,context:n}){this.#e.capture("sendFlowStart",{data:{assetType:t,context:n}})}onSendAssetAttempt(t){this.#e.capture("sendAssetAttempt",{data:{chainId:E.getChainID(t.networkId),...t}})}onSendAssetSuccess(t){this.#e.capture("sendAssetSuccess",{data:{chainId:E.getChainID(t.networkId),...t}})}onSendAssetFailure(t){this.#e.capture("sendAssetFailure",{data:{chainId:E.getChainID(t.networkId),...t}})}};i();a();i();a();var et=v(N()),Yo=[/Unknown instruction error/i,/Unknown error/i];function Bt({programId:e,customErrorCode:t,customErrorReason:n,errorReason:o}){let{t:r}=ke(),s=Ve(),m=n||o,f=r(m);return(0,et.useEffect)(()=>{s.capture("transactionErrorDetails",{data:{programId:e,customErrorCode:t,customErrorReason:n,errorReason:o,hasTranslatedErrorMessage:m!==f}})},[]),et.default.createElement(z,null,et.default.createElement(H,{align:"center",color:"textSecondary"},f,t&&Yo.some(l=>l.test(m))?` (${r("transactionsError")}: ${t})`:""))}var Qo=({sendSequenceAnalytics:e,onTransactionLinkPress:t,onClose:n,onCancel:o,onBack:r,mobileSignWithLedger:s,ledgerSupported:m})=>{let{data:[f]}=ot(["kill-base-history"]),{senderAddress:l,networkID:c,symbol:u,formattedRecipient:C,uiAmount:T,logoUri:D,tokenPrice:L,key:U}=se(),{data:M,status:S}=en(),x=(0,g.useMemo)(()=>M?.addresses??[],[M]),F=uo(),G=Et(),K=p(),A=(0,g.useMemo)(()=>At(c),[c]),{transactionSpeed:B,recipient:P}=K.sendFormValues,k=In(c,B,l,u,D??"",C,T.toNumber(),L,d.t),[I,w]=(0,g.useState)(!1),[_,$]=(0,g.useState)(null),[j,Se]=(0,g.useState)(null),{addRecentAddress:be}=Ce(),Ie=M?.type==="ledger",[R,ye]=(0,g.useState)(void 0),te=mn("send:fungible",c,!!s);Fn(U,T,R?R.id:"");let Pe=Cn(x),ne=(0,g.useCallback)(W=>{te(W.id,"confirmed"),F.onSendAssetSuccess({...G,txId:W.id}),Pe()},[F,te,Pe,G]),{isSuccess:le,isError:oe,error:X}=gn(ne,R??void 0),Ae=!!R,q=dt.get(c).sendSuccessCondition,re=(0,g.useMemo)(()=>{switch(q){case"SUBMISSION":return I?"ERROR":Ae?"SUCCESS":"LOADING";case"CONFIRMATION":return I||oe?"ERROR":le?"SUCCESS":"LOADING"}},[oe,le,I,Ae,q]),{isError:Z,isSuccess:ue}=(0,g.useMemo)(()=>({isError:re==="ERROR",isSuccess:re==="SUCCESS"}),[re]),_e=(0,g.useMemo)(()=>{let W=Be.get(c).transactionSpeedDescription(B??"standard");return W?d.t(W):""},[c,B]),De=q==="CONFIRMATION"?"sendStatusConfirmedSuccessTitle":"sendStatusSubmittedSuccessTitle",he=(0,g.useMemo)(()=>{switch(re){case"LOADING":return d.t("sendStatusLoadingTitle");case"ERROR":return d.t("sendStatusErrorTitle");case"SUCCESS":return d.t(De)}},[re,De]),$e=(0,g.useMemo)(()=>({titleText:he,retryText:d.t("commandRetry"),cancelText:d.t("commandCancel"),closeText:d.t("commandClose"),viewTransactionText:d.t("sendStatusViewTransaction")}),[he]);(0,g.useEffect)(()=>{le?(Ne.addBreadcrumb("fungibles","transactionStatus","info",{...A,status:"confirmed"}),R?.id&&e&&e.transactionStatus(R.id,{...A,status:{type:"confirmed"}})):Z&&(Ne.addBreadcrumb("fungibles","transactionStatus","error",{...A,status:"error"}),R?.id&&e&&e.transactionStatus(R.id,{...A,status:{type:"error"}}))},[le,Z,R,A,e]);let{mutateAsync:ie}=Sn(),ze=Z?g.default.createElement(g.default.Fragment,null,(W=>{switch(W){case"InsufficientFunds":return g.default.createElement(H,{color:"textSecondary",align:"center"},d.t("sendStatusErrorMessageInsufficientBalance"));case"UnknownError":default:return g.default.createElement(g.default.Fragment,null,g.default.createElement(H,{font:"bodySemibold",color:"textSecondary",align:"center"},g.default.createElement(lt,{i18nKey:"sendFungibleErrorMessageInterpolated",values:{uiAmount:T.toString(),assetSymbol:u,uiRecipient:C},components:{2:g.default.createElement(H,{font:"bodySemibold",color:"textPrimary"})}})),_?g.default.createElement(z,{marginTop:16,justifyContent:"center"},g.default.createElement(H,{font:"body",color:"textSecondary"},d.t("sendFungibleSolanaErrorCode",{code:_}))):null)}})(j??"InsufficientFunds"),X&&"data"in X?g.default.createElement(z,{marginY:16,justifyContent:"center",color:"textSecondary"},g.default.createElement(Bt,{errorReason:X.data.errorReason,programId:X.data.programId,customErrorReason:X.data.customErrorReason,customErrorCode:X.data.customErrorCode})):null):ue&&q==="CONFIRMATION"?g.default.createElement(H,{font:"bodySemibold",color:"textSecondary",align:"center"},g.default.createElement(lt,{i18nKey:"sendFungibleConfirmedSuccessMessageInterpolated",values:{uiAmount:T.toString(),assetSymbol:u,uiRecipient:C},components:{2:g.default.createElement(H,{font:"bodySemibold",color:"textPrimary"})}})):ue&&q==="SUBMISSION"?g.default.createElement(H,{font:"bodySemibold",align:"center"},d.t("sendStatusEstimatedTransactionTime",{time:_e})):g.default.createElement(H,{font:"bodySemibold",color:"textSecondary",align:"center"},g.default.createElement(lt,{i18nKey:"sendFungibleLoadingMessageInterpolated",values:{uiAmount:T.toString(),assetSymbol:u,uiRecipient:C},components:{2:g.default.createElement(H,{font:"bodySemibold",color:"textPrimary"})}})),Te=K.sendFormValues.multichainTransaction,{data:Ue}=Le({networkID:c,multichainTransaction:Te,transactionSpeed:B,queryOptions:{refetchInterval:!1}}),Y=p().gasEstimation,ae=Ue??Y,b=(0,g.useCallback)(async()=>{try{if(!Te)throw new Error("multichainTransaction is undefined on send status");if(!ae)throw new Error("gasEstimation is undefined on send status");be({address:P,chainID:c,timestamp:Date.now()});let W=Date.now();F.onSendAssetAttempt(G);let de=await ie({multichainTransaction:Te,pendingTransactionInput:k,senderAddress:l,gasEstimation:ae}),Me=de.id;te(Me,"initiated",W),te(Me,"received");let pe=At(c),fe;pe.chainType==="solana"&&e?(fe="signAndSendTransaction",e.submittedTransaction(de.id,{...pe,method:fe})):pe.chainType==="eip155"&&e?(fe="eth_sendRawTransaction",e.submittedTransaction(de.id,{...pe,method:fe})):pe.chainType==="sui"&&e?(fe="signAndExecuteTransaction",e.submittedTransaction(de.id,{...pe,method:fe})):pe.chainName==="bitcoin"&&e&&(fe="sendrawtransaction",e.submittedTransaction(de.id,{...pe,method:fe})),Ne.addBreadcrumb("fungibles","submittedTransaction","info",{...pe,txReceipt:de.id,method:fe??"UNKNOWN"}),ye(de)}catch(W){let de=Rn(W,A.chainType==="solana"?"solana":void 0);if(Se(de),de==="UnknownError"&&W instanceof Error&&A.chainType==="solana"){let[Me]=W.message.match(/0x\d+/)||[];typeof Me=="string"&&Me&&$(Me)}w(!0),F.onSendAssetFailure(G),Ne.captureError(W,"fungibles")}},[Te,P,ae,be,A,ie,k,te,c,F,e,l,G,w]),O=p(W=>W.retryArgs),Fe=(0,g.useCallback)(()=>{O?(ye(void 0),w(!1),b()):r()},[b,r,O]),{data:je}=Jt(R),bt=(0,g.useCallback)(()=>{je&&t(je)},[t,je]),Mt=(0,g.useCallback)(()=>{o()},[o]),Ao=(0,g.useCallback)(()=>{let{sendSuccessRedirect:W}=Be.get(c);n(W(f))},[n,f,c]),ho=qt(c),To=S==="pending",Fo=(0,g.useCallback)(()=>{m&&!ue&&!Z&&K.resetSendSlice()},[ue,Z,K,m]);return(0,po.default)(Fo),{handleClose:Ao,handleCancel:Mt,handleRetry:Fe,handleTransactionLinkPress:bt,isSuccess:ue,isError:Z,MessageElement:ze,title:he,txReceipt:R,handleTokenTransfer:b,i18nStrings:$e,isLoadingSelectedAccountStatus:To,isLedger:Ie,ledgerApp:ho}};i();a();var y=v(N());i();a();var me=v(N());var qo=J($n)`
  width: 100%;
  border-style: none;
  padding: 0;
`,fo=J(Hn).attrs({width:"28px",borderRadius:"50px",theme:"primary"})`
  height: 28px;
`,go=me.default.memo(({isExpanded:e,addressBookRecipient:t,clearRecipient:n})=>{let{t:o}=ke(),[r,s]=(0,me.useState)(!1),m={onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1)},f=r&&!t&&!e;return me.default.createElement(Wn,{color:"#000000",label:o("sendAddressBookButtonLabel"),ariaLabel:o("sendAddressBookButtonLabel"),alignment:"bottomRight",isVisible:f,triggerParams:m},t?me.default.createElement(fo,{paddingY:9,onClick:n},me.default.createElement(Vn,{fill:"#222",width:10})):me.default.createElement(qo,null,me.default.createElement(fo,{paddingY:6},me.default.createElement(Ln,{fill:"#222"}))))});i();a();var Pt=v(N());var So=Pt.default.memo(({symbol:e,chainName:t,recipient:n,recipientError:o,handleRecipientChange:r,onBlur:s})=>{let{t:m}=ke();return Pt.default.createElement(Gn,{type:"text",name:"recipient",value:n,autoComplete:"off",spellCheck:"false",placeholder:m("sendRecipientTextAreaPlaceholder2",{symbol:t||e}),warning:!!o,onChange:r,onBlur:s,paddingRight:"80px"})});var bo=J(Ye).attrs({size:16,weight:500,color:"#666666"})`
  font-style: italic;
`,Jo=J(_n)`
  width: 100%;
  position: relative;
`,er=J(Tt).attrs({align:"center"})`
  position: relative;
  border-radius: 6px;
  border: 1px solid #2f2f2f;
  padding: 14px;
  background: #181818;
  height: 50px;
  margin-bottom: 2px;
`,tr=J(zn)`
  z-index: 2;
  width: 100%;
`,Dt=J(Zn)`
  padding: 8px 12px;
  min-height: 41px;
`,nr=J(Tt).attrs({justify:"center"})`
  height: 85px;
`,yo=J(Ye).attrs({size:16,color:"#666666"})``,or=J.div`
  position: absolute;
  right: 12px;
  top: calc(50% - 28px / 2);
  width: auto;
  display: flex;
  gap: 12px;
  align-items: center;
`,rr="__none",sr=50,St=10,ir=e=>{let{addressBookRecipient:t,networkID:n,senderAddress:o,symbol:r,sendFormValues:s,sendFormErrors:m,recipientError:f,handleAddressSelection:l,setSendFormValues:c,setSendFormErrors:u,isLoading:C}=e,{t:T}=ke(),D=(0,y.useMemo)(()=>({sendAddressBookRecentlyUsed:T("sendAddressBookRecentlyUsed"),sendAddressBookNoAddressesSaved:T("sendAddressBookNoAddressesSaved")}),[T]),{data:L=[]}=we(),U=(0,y.useMemo)(()=>o?L.reduce((I,w)=>{let _=w.addresses.filter($=>$.networkID===n&&$.address!==o);if(n)for(let $ of _)I.push({label:w.name,address:$.address,chainID:n});return I},[]):[],[o,L,n]),{recentAddresses:M,savedAddresses:S}=Ce(),x=(0,y.useMemo)(()=>S.addresses.reduce((I,w)=>(n&&ht(E.getAddressTypes(w.chainID),E.getAddressTypes(n))&&I.push({...w}),I),[]),[S,n]),F=(0,y.useMemo)(()=>M.addresses.reduce((I,w)=>(n&&ht(E.getAddressTypes(w.chainID),E.getAddressTypes(n))&&I.push(w.address),I),[]),[M,n]),G=U.length===0&&x.length===0&&F.length===0,K=(0,y.useMemo)(()=>{for(let{address:I,label:w}of U)if(I===t)return w;for(let{address:I,label:w}of x)if(I===t)return w},[t,U,x]),{recipient:A}=s,B=(0,y.useCallback)(I=>{let w=I.currentTarget,_=self.getComputedStyle(w),$=parseInt(_.getPropertyValue("border-top-width"),St)+parseInt(_.getPropertyValue("padding-top"),St)+w.scrollHeight+parseInt(_.getPropertyValue("padding-bottom"),St)+parseInt(_.getPropertyValue("border-bottom-width"),St);$=w.value?Math.min(68,$-28):sr,w.style.height=`${$}px`,c({...s,recipient:w.value}),u({...m,recipientError:void 0})},[s,m,u,c]),P=(0,y.useCallback)(()=>{c({...s,recipient:"",addressBookRecipient:void 0})},[s,c]),k=(0,y.useMemo)(()=>{if(n)return E.getNetworkName(n)},[n]);return{i18nStrings:D,recipient:A,addressBookRecipient:t,addresses:U,savedAddresses:x,recentAddresses:F,isEmpty:G,selectedName:K,recipientError:f,symbol:r,chainName:k,handleAddressSelection:l,handleRecipientChange:B,clearRecipient:P,isLoading:C}},ac=y.default.memo(e=>{let t=ir(e);return y.default.createElement(ar,{...t})}),ar=y.default.memo(e=>{let{i18nStrings:t,recipient:n,addressBookRecipient:o,addresses:r,savedAddresses:s,recentAddresses:m,isEmpty:f,selectedName:l,recipientError:c,symbol:u,chainName:C,handleAddressSelection:T,handleRecipientChange:D,clearRecipient:L,isLoading:U=!1}=e;return y.default.createElement(Jo,{onChange:T,value:o??rr},({isExpanded:M})=>y.default.createElement(y.default.Fragment,null,o?y.default.createElement(er,null,l?y.default.createElement(Ye,{size:16,weight:500},l):y.default.createElement(bo,null,t.sendAddressBookRecentlyUsed),y.default.createElement(Ye,{opacity:.5,size:16,weight:400,margin:"0 0 0 6px"},"(",o.includes(".")?o:xe(o,4),")")):y.default.createElement(So,{symbol:u??"",chainName:C,recipient:n,recipientError:c,handleRecipientChange:D}),y.default.createElement(or,null,U?y.default.createElement(On,{diameter:20}):null,y.default.createElement(go,{isExpanded:M,addressBookRecipient:o,clearRecipient:L})),y.default.createElement(tr,{portal:!1},y.default.createElement(jn,{maxHeight:"150px"},r.map(({address:S,label:x,chainID:F},G)=>y.default.createElement(Dt,{key:`${S}-${G}`,value:S},y.default.createElement(Ft,{name:x,publicKey:S,publicKeyLabel:Yt(F,S)}))),s.map(({address:S,label:x},F)=>y.default.createElement(Dt,{key:`${S}-${F}`,value:S},y.default.createElement(Ft,{name:x,publicKey:S}))),m.map((S,x)=>y.default.createElement(Dt,{key:`${S}-${x}`,value:S},y.default.createElement(bo,null,t.sendAddressBookRecentlyUsed),y.default.createElement(yo,{opacity:.5},xe(S,4)))),f&&y.default.createElement(nr,null,y.default.createElement(yo,null,t.sendAddressBookNoAddressesSaved))))))});i();a();var Ke=v(N());var dr=()=>{let{uiAmount:e,symbol:t,formattedCurrencyAmount:n}=se(),o=Ge(e);return Ke.default.createElement(z,{direction:"column",alignItems:"center",marginTop:8,marginBottom:32},Ke.default.createElement(z,{marginBottom:16},Ke.default.createElement(mt,{icon:"Send2",size:64,color:"accentPrimary",backgroundColor:"bgTabBar",shape:"circle"})),Ke.default.createElement(H,{font:"heading1Semibold",align:"center"},o," ",t),n?Ke.default.createElement(H,{color:"textSecondary",font:"title2",align:"center"},n):null)};i();a();var Ut=v(N());var cr=({networkId:e,senderAddress:t})=>{let{data:n=[]}=we(),{recipient:o}=ut(),{sendAddressWarning:r,sendAddressVariant:s}=qe({senderAddress:t,senderAccounts:n,networkID:e,recipient:o});return r?Ut.default.createElement(z,{marginBottom:12},Ut.default.createElement(Pn,{level:s==="danger"?"1-critical-alert":"2-alert"},r)):null};i();a();i();a();var ur=v(N());i();a();var mr=v(N());i();a();var pr=v(N());i();a();export{kr as a,se as b,qe as c,Xo as d,Do as e,Uo as f,Bt as g,Qo as h,ac as i,dr as j,cr as k};
//# sourceMappingURL=chunk-M3LCIW7F.js.map
